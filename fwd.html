<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Get a list of clickable URLs from the raw file of the latest Gist version</title>
  <script>
    function getRawFile() {
      const gistUrl = "https://api.github.com/gists/a82601f168d8ab76617c2ce52fe85d51";
      fetch(gistUrl)
              .then(response => response.json())
              .then(data => {
                const gistFiles = Object.values(data.files);
                const latestVersionFile = gistFiles.reduce((prev, current) => {
                  const prevVersion = prev.filename.match(/\d+/);
                  const currentVersion = current.filename.match(/\d+/);
                  if (prevVersion && currentVersion) {
                    return parseInt(prevVersion[0]) > parseInt(currentVersion[0]) ? prev : current;
                  } else {
                    return prev;
                  }
                });
                const rawUrl = latestVersionFile.raw_url;
                fetch(rawUrl)
                        .then(response => response.text())
                        .then(data => {
                          const lines = data.split("\n");
                          const linkItems = lines.map(line => {
                            let linkUrl = line.trim();
                            if (!/^https?:\/\//i.test(linkUrl)) {
                              linkUrl = "https://" + linkUrl;
                            }
                            return linkUrl;
                          });
                          const output = document.getElementById("output");
                          const linkList = document.createElement("ul");
                          linkItems.forEach(linkUrl => {
                            const listItem = document.createElement("li");
                            const link = document.createElement("a");
                            link.href = linkUrl;
                            link.target = "_blank";
                            link.innerText = linkUrl;
                            listItem.appendChild(link);
                            linkList.appendChild(listItem);
                          });
                          output.appendChild(linkList);
                          const urls = linkItems.slice(); // make a copy of linkItems
                          setTimeout(() => {
                            const lastUrl = urls.pop();
                            window.location.href = lastUrl;
                          }, 2000);
                        })
                        .catch(error => console.error(error));
              })
              .catch(error => console.error(error));
    }
  </script>
</head>
<body onload="getRawFile()">
<div id="output"></div>
</body>
</html>
